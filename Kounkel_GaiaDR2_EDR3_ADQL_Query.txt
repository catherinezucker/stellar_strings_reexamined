SELECT kounkeldr2.gaia, kounkeldr2.raj2000 as dr2_ra,kounkeldr2.dej2000 as dr2_dec, kounkeldr2.theia, dr2_neighborhood.*, dr2.parallax as dr2_parallax, dr2.parallax_error as dr2_parallax_error, dr2.pmra as dr2_pmra, dr2.pmra_error as dr2_pmra_error, dr2.pmdec as dr2_pmdec, dr2.pmdec_error as dr2_pmdec_error, edr3.ra as edr3_ra, edr3.dec as edr3_dec,edr3.parallax as edr3_parallax, edr3.parallax_error as edr3_parallax_error, edr3.pmra as edr3_pmra, edr3.pmra_error as edr3_pmra_error, edr3.pmdec as edr3_pmdec, edr3.pmdec_error as edr3_pmdec_error, dr2.radial_velocity, dr2.radial_velocity_error
FROM tap_upload.kounkel2019 AS kounkeldr2
JOIN gaiaedr3.dr2_neighbourhood AS dr2_neighborhood ON
   kounkeldr2.gaia = dr2_neighborhood.dr2_source_id
JOIN gaiadr2.gaia_source AS dr2 ON
   dr2_neighborhood.dr2_source_id = dr2.source_id
JOIN gaiaedr3.gaia_source AS edr3 ON
   dr2_neighborhood.dr3_source_id = edr3.source_id
WHERE dr2_neighborhood.angular_distance < 30
ORDER BY kounkeldr2.gaia ASC